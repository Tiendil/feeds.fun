version: "3.9"


volumes:
  ffun_postgresql_data: {}


networks:
  ffun_network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.22.0.0/16


services:

  postgresql:
    image: postgres:15-bullseye

    volumes:
      - ffun_postgresql_data:/data
      - ./docker/postgresql/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d

    environment:
      POSTGRES_MULTIPLE_DATABASES: ffun,supertokens
      POSTGRES_USER: ffun
      POSTGRES_PASSWORD: ffun

    ports:
      - "5432:5432"

    networks:
      ffun_network: {}

  supertokens:
    image: registry.supertokens.io/supertokens/supertokens-postgresql

    environment:
      POSTGRESQL_DATABASE_NAME: "supertokens"
      POSTGRESQL_USER: "supertokens"
      POSTGRESQL_PASSWORD: "supertokens"
      POSTGRESQL_HOST: "postgresql"
      POSTGRESQL_PORT: "5432"

    ports:
      - "3567:3567"

    networks:
      ffun_network: {}
